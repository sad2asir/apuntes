import{_ as i,a as d}from"./comandotree-ef7769e5.js";import{_ as y,r as p,o as u,c as m,b as n,a as s,w as l,d as a,e as r}from"./app-7eaa5ff0.js";const v={},E=s("h1",{id:"_2-2-gestion-de-procesos-en-java-processbuilder-y-process",tabindex:"-1"},"2.2 Gestión de procesos en Java - ProcessBuilder y Process",-1),b={class:"table-of-contents"},g=s("h2",{id:"_2-2-1-preparacion-y-configuracion-de-un-proceso",tabindex:"-1"},"2.2.1 Preparación y configuración de un proceso",-1),A=s("p",null,[a("En el paquete "),s("code",null,"java.lang"),a(" tenemos dos clases para la gestión de procesos.")],-1),F=s("code",null,"java.lang.ProcessBuilder",-1),D={href:"https://docs.oracle.com/javase/8/docs/api/java/lang/ProcessBuilder.html",target:"_blank",rel:"noopener noreferrer"},q=s("code",null,"java.lang.Process",-1),h={href:"https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/lang/ProcessBuilder.html",target:"_blank",rel:"noopener noreferrer"},C=r(`<p>Las instancias de <strong>ProcessBuilder</strong> gestionan los atributos de los procesos, mientras que las instancias de <strong>Process</strong> controlan la ejecución de esos mismos procesos cuando se ejecutan.</p><p>Antes de ejecutar un nuevo proceso, podemos configurar los parámetros de ejecución del mismo usando la clase <code>ProcessBuilder</code>.</p><p>ProcessBuilder es una clase auxiliar de la clase Process, que veremos más adelante, y se utiliza para controlar algunos parámetros de ejecución que afectarán al proceso. A través de la llamada al método <code>start</code> se crea un nuevo proceso en el sistema con los atributos definidos en la instancia de ProcessBuilder.</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="shiki github-light" style="background-color:#fff;" tabindex="0"><code><span class="line"><span style="color:#24292E;">    ProcessBuilder pb </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">new</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">ProcessBuilder</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;CMD&quot;</span><span style="color:#24292E;">, </span><span style="color:#032F62;">&quot;/C&quot;</span><span style="color:#24292E;">, </span><span style="color:#032F62;">&quot;DIR&quot;</span><span style="color:#24292E;">);</span></span>
<span class="line"><span style="color:#24292E;">    Process p </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> pb.</span><span style="color:#6F42C1;">start</span><span style="color:#24292E;">();</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><p>Si llamamos varias veces al método start, se crearán tantos nuevos procesos como llamadas hagamos, todos ellos con los mismos atributos.</p><p>La clase ProcessBuilder define un par de constructores:</p><div class="language-java" data-ext="java"><pre class="shiki github-light" style="background-color:#fff;" tabindex="0"><code><span class="line"><span style="color:#6F42C1;">ProcessBuilder</span><span style="color:#24292E;">(List</span><span style="color:#D73A49;">&lt;</span><span style="color:#24292E;">String</span><span style="color:#D73A49;">&gt;</span><span style="color:#24292E;"> command)</span></span>
<span class="line"><span style="color:#6F42C1;">ProcessBuilder</span><span style="color:#24292E;">(String... command)</span></span>
<span class="line"></span></code></pre></div><p>El funcionamiento de ambos es el mismo. En el primer constructor se pasa el comando a ejecutar y la lista de argumentos como una lista de cadenas. Por contra, en el segundo constructor, el comando y sus argumentos se pasan a través de un número variable de cadenas (String ... es lo que en Java se llama varargs). La versión que utilicemos depende del formato en que tengamos los datos.</p><div class="custom-container danger"><p class="custom-container-title">Argumentos y parámetros</p><p>Si queremos lanzar un programa con parámetros (modificadores que hacen que cambie la forma de funcionar un programa como -h /s ...) el comando no puede ser pasado al constructor directamente como un único string, debe ser preprocesado para convertirlo en una lista y que funcione.</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="shiki github-light" style="background-color:#fff;" tabindex="0"><code><span class="line"><span style="color:#6A737D;">// Formas diferentes de pasar el comando a los constructores de ProcessBuilder</span></span>
<span class="line"><span style="color:#6A737D;">// 1ª forma: usando una cadena. Falla con parámetros</span></span>
<span class="line"><span style="color:#6A737D;">// Sólo funciona con programas que tengan argumentos</span></span>
<span class="line"><span style="color:#24292E;">String command1 </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&quot;notepad.exe prueba1.txt&quot;</span></span>
<span class="line"><span style="color:#24292E;">ProcessBuilder pb </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">new</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">ProcessBuilder</span><span style="color:#24292E;">(command1);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;">// 2ª forma: usando un array de cadenas. Funciona con parámetros</span></span>
<span class="line"><span style="color:#D73A49;">String</span><span style="color:#24292E;">[] command2 </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> {</span><span style="color:#032F62;">&quot;cmd&quot;</span><span style="color:#24292E;">, </span><span style="color:#032F62;">&quot;/c&quot;</span><span style="color:#24292E;">, </span><span style="color:#032F62;">&quot;dir&quot;</span><span style="color:#24292E;">, </span><span style="color:#032F62;">&quot;/o&quot;</span><span style="color:#24292E;">};</span></span>
<span class="line"><span style="color:#24292E;">ProcessBuilder pb </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">new</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">ProcessBuilder</span><span style="color:#24292E;">(command2);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;">// 3ª forma: usando una cadena y dividiéndola para convertirla en una lista</span></span>
<span class="line"><span style="color:#24292E;">String command3 </span><span style="color:#D73A49;">=</span><span style="color:#24292E;">  </span><span style="color:#032F62;">&quot;c:/windows/system32/shutdown -s -t 0&quot;</span><span style="color:#24292E;">;  </span></span>
<span class="line"><span style="color:#6A737D;">// La expresión regular \\s significa partir por los espacios en blanco</span></span>
<span class="line"><span style="color:#24292E;">ProcessBuilder pb </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">new</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">ProcessBuilder</span><span style="color:#24292E;">(command3.</span><span style="color:#6F42C1;">split</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;</span><span style="color:#005CC5;">\\\\</span><span style="color:#032F62;">s&quot;</span><span style="color:#24292E;">));</span></span>
<span class="line"><span style="color:#6A737D;">// ESTA ES LA MEJOR FORMA PARA QUE FUNCIONE EN TODOS LOS CASOS</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></div>`,9),f={class:"custom-container warning"},j=s("p",{class:"custom-container-title"},"Apagar el sistema operativo",-1),S=s("p",null,[a("El comando "),s("code",null,"shutdown -s"),a(" sirve para apagar el sistema. En windows es necesario proporcionar la ruta completa al comando, por ejemplo C:\\Windows\\System32\\shutdown.")],-1),P=s("p",null,"Podemos usar como parámetro -s para apagar el sistema, , -r para reiniciar , -h para hibernar y -t para indicar un tiempo de espera antes de apagar.",-1),x={href:"https://docs.microsoft.com/en-us/windows-server/administration/windows-commands/shutdown",target:"_blank",rel:"noopener noreferrer"},_=r(`<div class="custom-container question"><p class="custom-container-title">Activity psp.activities.U2A1_Shutdowner</p><p>Crea una nuevo proyecto Java (package psp.actividades y como clase principal U2A1_Shutdowner). Usando la línea de comandos, pide al usuario qué acción quiere realizar (apagar, reiniciar o suspender) y cuánto tiempo quiere dejar antes de realizar la acción de apagado del sistema..</p><p>Busca información sobre el funcionamiento del comando shutdown en GNU/Linux y haz que tu aplicación funcione para ambos sistemas..</p><p>La aplicación tiene que preparar el comando correcto para la selección que haya hecho el usuario y para el sistema operativo en el que la esté ejecutando.</p><p>Muestra por consola el resultado del método ProcessBuilder.command() de forma legible.</p></div><details class="custom-container details"><summary>Solución de U2A1_Shutdowner</summary><div class="language-java line-numbers-mode" data-ext="java"><pre class="shiki github-light" style="background-color:#fff;" tabindex="0"><code><span class="line"><span style="color:#D73A49;">public</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">class</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">U2A1_Shutdowner</span><span style="color:#24292E;"> {</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">public</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">static</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">void</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">main</span><span style="color:#24292E;">(</span><span style="color:#D73A49;">String</span><span style="color:#24292E;">[] </span><span style="color:#E36209;">args</span><span style="color:#24292E;">) </span><span style="color:#D73A49;">throws</span><span style="color:#24292E;"> IOException {</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#6A737D;">// Ask for the required information to prepare the command</span></span>
<span class="line"><span style="color:#24292E;">        Scanner keyboard </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">new</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">Scanner</span><span style="color:#24292E;">(System.in);</span></span>
<span class="line"><span style="color:#24292E;">        </span></span>
<span class="line"><span style="color:#24292E;">        System.out.</span><span style="color:#6F42C1;">print</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;Select your option (s-shutdown / r-reboot / h-hibernate): &quot;</span><span style="color:#24292E;">);</span></span>
<span class="line"><span style="color:#24292E;">        String shutdownOption </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> keyboard.</span><span style="color:#6F42C1;">nextLine</span><span style="color:#24292E;">();        </span></span>
<span class="line"><span style="color:#24292E;">        </span></span>
<span class="line"><span style="color:#24292E;">        System.out.</span><span style="color:#6F42C1;">print</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;How much seconds will the command wait to be run? (0 means immediately): &quot;</span><span style="color:#24292E;">);</span></span>
<span class="line"><span style="color:#24292E;">        String shutdownTime </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> keyboard.</span><span style="color:#6F42C1;">nextLine</span><span style="color:#24292E;">();        </span></span>
<span class="line"><span style="color:#24292E;">        </span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#6A737D;">// Prepare the command</span></span>
<span class="line"><span style="color:#24292E;">        String command;</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#D73A49;">if</span><span style="color:#24292E;"> (System.</span><span style="color:#6F42C1;">getProperty</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;os.name&quot;</span><span style="color:#24292E;">).</span><span style="color:#6F42C1;">toLowerCase</span><span style="color:#24292E;">().</span><span style="color:#6F42C1;">startsWith</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;windows&quot;</span><span style="color:#24292E;">)) {</span></span>
<span class="line"><span style="color:#24292E;">            command </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&quot;C:/Windows/System32/shutdown -&quot;</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">+</span><span style="color:#24292E;"> shutdownOption </span><span style="color:#D73A49;">+</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&quot; -t &quot;</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">+</span><span style="color:#24292E;"> shutdownTime;</span></span>
<span class="line"><span style="color:#24292E;">        } </span><span style="color:#D73A49;">else</span><span style="color:#24292E;"> {</span></span>
<span class="line"><span style="color:#24292E;">            command </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&quot;shutdown -&quot;</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">+</span><span style="color:#24292E;"> shutdownOption </span><span style="color:#D73A49;">+</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&quot; -t &quot;</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">+</span><span style="color:#24292E;"> shutdownTime;</span></span>
<span class="line"><span style="color:#24292E;">        }</span></span>
<span class="line"><span style="color:#24292E;">        </span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#6A737D;">// Prepare the process and launch it</span></span>
<span class="line"><span style="color:#24292E;">        ProcessBuilder shutdowner </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">new</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">ProcessBuilder</span><span style="color:#24292E;">(command.</span><span style="color:#6F42C1;">split</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;</span><span style="color:#005CC5;">\\\\</span><span style="color:#032F62;">s&quot;</span><span style="color:#24292E;">));</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#6A737D;">//shutdowner.start();</span></span>
<span class="line"><span style="color:#24292E;">        </span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#6A737D;">// Show the command to be run</span></span>
<span class="line"><span style="color:#24292E;">        System.out.</span><span style="color:#6F42C1;">print</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;El comando a ejecutar es:  &quot;</span><span style="color:#24292E;">);</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#D73A49;">for</span><span style="color:#24292E;"> (String commandPart</span><span style="color:#D73A49;">:</span><span style="color:#24292E;"> shutdowner.</span><span style="color:#6F42C1;">command</span><span style="color:#24292E;">()) {</span></span>
<span class="line"><span style="color:#24292E;">            System.out.</span><span style="color:#6F42C1;">print</span><span style="color:#24292E;">(commandPart </span><span style="color:#D73A49;">+</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&quot; &quot;</span><span style="color:#24292E;">);</span></span>
<span class="line"><span style="color:#24292E;">        }</span></span>
<span class="line"><span style="color:#24292E;">        System.out.</span><span style="color:#6F42C1;">println</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;&quot;</span><span style="color:#24292E;">);</span></span>
<span class="line"><span style="color:#24292E;">    }    </span></span>
<span class="line"><span style="color:#24292E;">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></details><h3 id="modificar-el-comando-en-tiempo-de-ejecucion" tabindex="-1">Modificar el comando en tiempo de ejecución</h3><p>Puede ser que todo el comando, o parte del mismo, no lo tengamos en el momento de llamar a los constructores de ProcessBuilder. Se puede cambiar, modificar y consultar a posteriori con el método <code>command</code></p><p>Al igual que con los constructores, tenemos dos versiones del método command</p><div class="language-java" data-ext="java"><pre class="shiki github-light" style="background-color:#fff;" tabindex="0"><code><span class="line"><span style="color:#24292E;">    </span><span style="color:#6F42C1;">command</span><span style="color:#24292E;">(List</span><span style="color:#D73A49;">&lt;</span><span style="color:#24292E;">String</span><span style="color:#D73A49;">&gt;</span><span style="color:#24292E;"> command)</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#6F42C1;">command</span><span style="color:#24292E;">(String... command)</span></span>
<span class="line"></span></code></pre></div><p>y la tercera forma de este método (sin parámetros) sirve para obtener una lista del comando pasado al constructor o puesto con alguna de las formas anterior del método command. Lo interesante es que una vez que tenemos la lista, podemos modificarla usando los métodos de la clase List.</p><p>En el siguiente ejemplo, en el momento de definir el comando, nos falta saber la última parte, el directorio temporal. Además, si queremos hacer que la ejecución sea multiplataforma, el shell a ejecutar tampoco lo sabemos. Dependiendo del SO se añaden dos valores al principio y un valor al final, con el método add de la clase List.</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="shiki github-light" style="background-color:#fff;" tabindex="0"><code><span class="line"><span style="color:#6A737D;">// Sets and modifies the command after ProcessBuilder object is created</span></span>
<span class="line"><span style="color:#24292E;">String command </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&quot;java -jar install.jar -install&quot;</span><span style="color:#24292E;">; </span><span style="color:#6A737D;">// tmp dir is missing</span></span>
<span class="line"><span style="color:#24292E;">ProcessBuilder pbuilder </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">new</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">ProcessBuilder</span><span style="color:#24292E;">(command.</span><span style="color:#6F42C1;">split</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;</span><span style="color:#005CC5;">\\\\</span><span style="color:#032F62;">s&quot;</span><span style="color:#24292E;">));</span></span>
<span class="line"><span style="color:#D73A49;">if</span><span style="color:#24292E;"> (isWindows) {</span></span>
<span class="line"><span style="color:#24292E;">    pbuilder.</span><span style="color:#6F42C1;">command</span><span style="color:#24292E;">().</span><span style="color:#6F42C1;">add</span><span style="color:#24292E;">(</span><span style="color:#005CC5;">0</span><span style="color:#24292E;">, </span><span style="color:#032F62;">&quot;cmd&quot;</span><span style="color:#24292E;">); </span><span style="color:#6A737D;">// Sets the 1st element</span></span>
<span class="line"><span style="color:#24292E;">    pbuilder.</span><span style="color:#6F42C1;">command</span><span style="color:#24292E;">().</span><span style="color:#6F42C1;">add</span><span style="color:#24292E;">(</span><span style="color:#005CC5;">1</span><span style="color:#24292E;">, </span><span style="color:#032F62;">&quot;/c&quot;</span><span style="color:#24292E;">); </span><span style="color:#6A737D;">// Sets the 2nd element</span></span>
<span class="line"><span style="color:#24292E;">    pbuilder.</span><span style="color:#6F42C1;">command</span><span style="color:#24292E;">().</span><span style="color:#6F42C1;">add</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;c:/temp&quot;</span><span style="color:#24292E;">); </span><span style="color:#6A737D;">// Sets the last element</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#6A737D;">// Command to run cmd /c java -jar install.jar -install c:/temp</span></span>
<span class="line"><span style="color:#24292E;">} </span><span style="color:#D73A49;">else</span><span style="color:#24292E;"> {</span></span>
<span class="line"><span style="color:#24292E;">    pbuilder.</span><span style="color:#6F42C1;">command</span><span style="color:#24292E;">().</span><span style="color:#6F42C1;">add</span><span style="color:#24292E;">(</span><span style="color:#005CC5;">0</span><span style="color:#24292E;">, </span><span style="color:#032F62;">&quot;sh&quot;</span><span style="color:#24292E;">); </span><span style="color:#6A737D;">// Sets the 1st element</span></span>
<span class="line"><span style="color:#24292E;">    pbuilder.</span><span style="color:#6F42C1;">command</span><span style="color:#24292E;">().</span><span style="color:#6F42C1;">add</span><span style="color:#24292E;">(</span><span style="color:#005CC5;">1</span><span style="color:#24292E;">, </span><span style="color:#032F62;">&quot;-c&quot;</span><span style="color:#24292E;">); </span><span style="color:#6A737D;">// Sets the 2nd element</span></span>
<span class="line"><span style="color:#24292E;">    pbuilder.</span><span style="color:#6F42C1;">command</span><span style="color:#24292E;">().</span><span style="color:#6F42C1;">add</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;/tmp&quot;</span><span style="color:#24292E;">); </span><span style="color:#6A737D;">// Sets the last element</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#6A737D;">// Command to run: sh -c java -jar install.jar -install /tmp</span></span>
<span class="line"><span style="color:#24292E;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;">// Starts the process</span></span>
<span class="line"><span style="color:#24292E;">pbuilder.</span><span style="color:#6F42C1;">start</span><span style="color:#24292E;">();</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="configuraciones-adicionales-de-un-proceso" tabindex="-1">Configuraciones adicionales de un proceso</h3><p>Algunos de los atributos que podemos configurar para un proceso son:</p><ul><li><p>Establecer el directorio de trabajo donde el proceso se ejecutará</p><p>Podemos cambiar el directorio de trabajo por defecto llamando al método <code>directory</code> y pasándole un objeto de tipo File. <strong>Por defecto, el directorio de trabajo se establece al valor de la variable del sistema user.dir</strong>. Este directorio es el punto de partida para acceder a ficheros, imágenes y todos los recursos que necesite nuestra aplicación.</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="shiki github-light" style="background-color:#fff;" tabindex="0"><code><span class="line"><span style="color:#6A737D;">// Cambia el directorio de trabajo a la carpeta personal del usuario</span></span>
<span class="line"><span style="color:#24292E;">pbuilder.</span><span style="color:#6F42C1;">directory</span><span style="color:#24292E;">(</span><span style="color:#D73A49;">new</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">File</span><span style="color:#24292E;">(System.</span><span style="color:#6F42C1;">getProperty</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;user.home&quot;</span><span style="color:#24292E;">)));</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div></li><li><p>Configurar o modificar variables de entorno para el proceso con el método <code>environment()</code></p><div class="language-java line-numbers-mode" data-ext="java"><pre class="shiki github-light" style="background-color:#fff;" tabindex="0"><code><span class="line"><span style="color:#6A737D;">// Retrieve and modify the process environment</span></span>
<span class="line"><span style="color:#24292E;">Map&lt;</span><span style="color:#D73A49;">String</span><span style="color:#24292E;">, </span><span style="color:#D73A49;">String</span><span style="color:#24292E;">&gt; environment </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> pbuilder.</span><span style="color:#6F42C1;">environment</span><span style="color:#24292E;">();</span></span>
<span class="line"><span style="color:#6A737D;">// Get the PATH environment variable and add a new directory</span></span>
<span class="line"><span style="color:#24292E;">String systemPath </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> environment.</span><span style="color:#6F42C1;">get</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;path&quot;</span><span style="color:#24292E;">) </span><span style="color:#D73A49;">+</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&quot;;c:/users/public&quot;</span><span style="color:#24292E;">;</span></span>
<span class="line"><span style="color:#24292E;">environment.</span><span style="color:#6F42C1;">replace</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;path&quot;</span><span style="color:#24292E;">, systemPath);</span></span>
<span class="line"><span style="color:#6A737D;">// Add a new environment variable and use it as a part of the command</span></span>
<span class="line"><span style="color:#24292E;">environment.</span><span style="color:#6F42C1;">put</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;GREETING&quot;</span><span style="color:#24292E;">, </span><span style="color:#032F62;">&quot;Hola Mundo&quot;</span><span style="color:#24292E;">);</span></span>
<span class="line"><span style="color:#24292E;">processBuilder.</span><span style="color:#6F42C1;">command</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;/bin/bash&quot;</span><span style="color:#24292E;">, </span><span style="color:#032F62;">&quot;-c&quot;</span><span style="color:#24292E;">, </span><span style="color:#032F62;">&quot;echo $GREETING&quot;</span><span style="color:#24292E;">);</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-java line-numbers-mode" data-ext="java"><pre class="shiki github-light" style="background-color:#fff;" tabindex="0"><code><span class="line"><span style="color:#6A737D;">// Indicamos el directorio donde se encuentra el ejecutable</span></span>
<span class="line"><span style="color:#24292E;">File directorio </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">new</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">File</span><span style="color:#24292E;"> (</span><span style="color:#032F62;">&quot;bin&quot;</span><span style="color:#24292E;">);</span></span>
<span class="line"><span style="color:#24292E;">pb.</span><span style="color:#6F42C1;">directory</span><span style="color:#24292E;">(directorio);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;">// Mostramos la información de las variables de entorno</span></span>
<span class="line"><span style="color:#24292E;">Map variablesEntorno </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> pb.</span><span style="color:#6F42C1;">environment</span><span style="color:#24292E;">();</span></span>
<span class="line"><span style="color:#24292E;">System.out.</span><span style="color:#6F42C1;">println</span><span style="color:#24292E;">(variablesEntorno);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;">// Mostramos el nombre del proceso y sus argumentos</span></span>
<span class="line"><span style="color:#24292E;">List command </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> pb.</span><span style="color:#6F42C1;">command</span><span style="color:#24292E;">();</span></span>
<span class="line"><span style="color:#24292E;">Iterator iter </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> l.</span><span style="color:#6F42C1;">iterator</span><span style="color:#24292E;">();</span></span>
<span class="line"><span style="color:#D73A49;">while</span><span style="color:#24292E;"> (iter.</span><span style="color:#6F42C1;">hasNext</span><span style="color:#24292E;">()) {</span></span>
<span class="line"><span style="color:#24292E;">    System.out.</span><span style="color:#6F42C1;">println</span><span style="color:#24292E;">(iter.</span><span style="color:#6F42C1;">next</span><span style="color:#24292E;">());</span></span>
<span class="line"><span style="color:#24292E;">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="custom-container info"><p class="custom-container-title">Variables de entorno vs Propiedades del sistema</p><p>Con la clase Runtime accedemos a las variables del sistema mientras que con ProcessBuilder lo hacemos a las propiedades del sistema, que son diferentes.</p></div></li><li><p>Redireccionar la entrada y salida estándar</p></li><li><p>Heredar la E/S estándar del proceso padre usando el método ProcessBuilder.inheritIO()</p><p><em>Estas dos configuraciones se verán en el siguiente apartado.</em></p></li></ul><div class="custom-container question"><p class="custom-container-title">Actividad psp.activities.U2A2_DirectorioTrabajo</p><p>Crea un nuevo proyecto Java (Ant &gt; Java Application) (configura como nombre del proyecto U2A2_DirectorioTrabajo y como clase principal psp.activities.U2A2_WorkingDirectory) Escribe un programa que ejecute el comando ls o dir. Modifica el valor de la propiedad user.dir. En la misma aplicación, cambiar el directorio de trabajo a la carpeta c:/temp o /tmp, dependiendo del sistema operativo.</p><p>Muestra el valor devuelto por el método directory()</p><ul><li>Después de crear la instancia de ProcessBuilder</li><li>Después de cambiar el valor de user.dir</li><li>Después de cambiar el directorio de trabajo al directorio temporal del sistema.</li></ul><p><em>En este momento tu programa todavía no mostrará ningún listado.</em></p></div><details class="custom-container details"><summary>Solución de U2A2_DirectorioTrabajo</summary><div class="language-java line-numbers-mode" data-ext="java"><pre class="shiki github-light" style="background-color:#fff;" tabindex="0"><code><span class="line"><span style="color:#D73A49;">public</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">class</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">U2A2_WorkingDirectory</span><span style="color:#24292E;"> {</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">public</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">static</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">void</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">main</span><span style="color:#24292E;">(</span><span style="color:#D73A49;">String</span><span style="color:#24292E;">[] </span><span style="color:#E36209;">args</span><span style="color:#24292E;">) </span><span style="color:#D73A49;">throws</span><span style="color:#24292E;"> IOException {</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#6A737D;">// Prepare the command</span></span>
<span class="line"><span style="color:#24292E;">        String command;</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#D73A49;">if</span><span style="color:#24292E;"> (System.</span><span style="color:#6F42C1;">getProperty</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;os.name&quot;</span><span style="color:#24292E;">).</span><span style="color:#6F42C1;">toLowerCase</span><span style="color:#24292E;">().</span><span style="color:#6F42C1;">startsWith</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;windows&quot;</span><span style="color:#24292E;">)) {</span></span>
<span class="line"><span style="color:#24292E;">            command </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&quot;cmd /c dir&quot;</span><span style="color:#24292E;">;</span></span>
<span class="line"><span style="color:#24292E;">        } </span><span style="color:#D73A49;">else</span><span style="color:#24292E;"> {</span></span>
<span class="line"><span style="color:#24292E;">            command </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&quot;sh -c ls&quot;</span><span style="color:#24292E;">;</span></span>
<span class="line"><span style="color:#24292E;">        }</span></span>
<span class="line"><span style="color:#24292E;">        </span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#6A737D;">// Prepare the process and launch it</span></span>
<span class="line"><span style="color:#24292E;">        ProcessBuilder commander </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">new</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">ProcessBuilder</span><span style="color:#24292E;">(command.</span><span style="color:#6F42C1;">split</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;</span><span style="color:#005CC5;">\\\\</span><span style="color:#032F62;">s&quot;</span><span style="color:#24292E;">));</span></span>
<span class="line"><span style="color:#24292E;">        </span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#6A737D;">//1st - Default working directory</span></span>
<span class="line"><span style="color:#24292E;">        System.out.</span><span style="color:#6F42C1;">println</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;Working directory: &quot;</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">+</span><span style="color:#24292E;"> commander.</span><span style="color:#6F42C1;">directory</span><span style="color:#24292E;">());</span></span>
<span class="line"><span style="color:#24292E;">        System.out.</span><span style="color:#6F42C1;">println</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;user.dir variable: &quot;</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">+</span><span style="color:#24292E;"> System.</span><span style="color:#6F42C1;">getProperty</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;user.dir&quot;</span><span style="color:#24292E;">));</span></span>
<span class="line"><span style="color:#24292E;">        </span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#6A737D;">//2nd - Set the user.dir</span></span>
<span class="line"><span style="color:#24292E;">        System.</span><span style="color:#6F42C1;">setProperty</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;user.dir&quot;</span><span style="color:#24292E;">, System.</span><span style="color:#6F42C1;">getProperty</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;user.home&quot;</span><span style="color:#24292E;">));</span></span>
<span class="line"><span style="color:#24292E;">        System.out.</span><span style="color:#6F42C1;">println</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;Working directory: &quot;</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">+</span><span style="color:#24292E;"> commander.</span><span style="color:#6F42C1;">directory</span><span style="color:#24292E;">());</span></span>
<span class="line"><span style="color:#24292E;">        System.out.</span><span style="color:#6F42C1;">println</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;user.dir variable: &quot;</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">+</span><span style="color:#24292E;"> System.</span><span style="color:#6F42C1;">getProperty</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;user.dir&quot;</span><span style="color:#24292E;">));</span></span>
<span class="line"><span style="color:#24292E;">        </span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#6A737D;">// 3rd - Change the working directory</span></span>
<span class="line"><span style="color:#24292E;">        commander.</span><span style="color:#6F42C1;">directory</span><span style="color:#24292E;">(</span><span style="color:#D73A49;">new</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">File</span><span style="color:#24292E;">(System.</span><span style="color:#6F42C1;">getProperty</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;user.home&quot;</span><span style="color:#24292E;">)));</span></span>
<span class="line"><span style="color:#24292E;">        System.out.</span><span style="color:#6F42C1;">println</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;Working directory: &quot;</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">+</span><span style="color:#24292E;"> commander.</span><span style="color:#6F42C1;">directory</span><span style="color:#24292E;">().</span><span style="color:#6F42C1;">toString</span><span style="color:#24292E;">());</span></span>
<span class="line"><span style="color:#24292E;">        System.out.</span><span style="color:#6F42C1;">println</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;user.dir variable: &quot;</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">+</span><span style="color:#24292E;"> System.</span><span style="color:#6F42C1;">getProperty</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;user.dir&quot;</span><span style="color:#24292E;">));</span></span>
<span class="line"><span style="color:#24292E;">        </span></span>
<span class="line"><span style="color:#24292E;">        commander.</span><span style="color:#6F42C1;">start</span><span style="color:#24292E;">();        </span></span>
<span class="line"><span style="color:#24292E;">    }</span></span>
<span class="line"><span style="color:#24292E;">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></details><div class="pagebreak"></div><h2 id="_2-2-2-acceso-al-proceso-una-vez-en-ejecucion" tabindex="-1">2.2.2 Acceso al proceso una vez en ejecución</h2><p>LA clase <code>Process</code> es una clase abstracta definida en el paquete java.lang y contiene la información del proceso en ejecución. Tras invocar al método <code>start</code> de ProcessBuilder, éste devuelve una referencia al proceso en forma de objeto Process.</p><p>Los métodos de la clase Process pueden ser usados para realizar operaciones de E/S desde el proceso, para comprobar su estado, su valor de retorno, para esperar a que termine de ejecutarse y para forzar la terminación del proceso. Sin embargo estos métodos no funcionan sobre procesos especiales del SO como pueden ser servicios, shell scripts, demonios, etc.</p>`,18),w={href:"https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/lang/Process.html",target:"_blank",rel:"noopener noreferrer"},k=r(`<div class="custom-container warning"><p class="custom-container-title">Entrada / Salida desde el proceso hijo</p><p>Curiosamente <strong>los procesos lanzados con el método start() no tienen una consola asignada.</strong>. Por contra, estos procesos redireccionan los streams de E/S estándar (stdin, stdout, stderr) al proceso padre. Si se necesita, se puede acceder a ellos a través de los streams obtenidos con los métodos definidos en la clase Process como getInputStream(), getOutputStream() y getErrorSteam(). Esta es la forma de enviar y recibir información desde los subprocesos.</p></div><p>Los principales métodos de esta clase son:</p><table><thead><tr><th style="text-align:left;">Método</th><th style="text-align:left;">Descripción</th></tr></thead><tbody><tr><td style="text-align:left;">int exitValue()</td><td style="text-align:left;">Código de finalización devuelto por el proceso hijo (ver Info más abajo)</td></tr><tr><td style="text-align:left;">Boolean isAlive()</td><td style="text-align:left;">Comprueba si el proceso todavía está en ejecución</td></tr><tr><td style="text-align:left;">int waitFor()</td><td style="text-align:left;">hace que el proceso padre se quede esperando a que el proceso hijo termine. El entrono que devuelve es el código de finalización del proceso hijo</td></tr><tr><td style="text-align:left;">Boolean waitFor(long timeOut, TimeUnit unit)</td><td style="text-align:left;">El funcionamiento es el mismo que en el caos anterior sólo que en esta ocasión podemos especificar cuánto tiempo queremos esperar a que el proceso hijo termine. El método devuelve true si el proceso termina antes de que pase el tiempo indicado y false si ha pasado el tiempo y el proceso no ha terminado.</td></tr><tr><td style="text-align:left;">void destroy()</td><td style="text-align:left;">Estos dos métodos se utilizan para matar al proceso. El segundo lo hace de forma forzosa.</td></tr><tr><td style="text-align:left;">Process destroyForcibly()</td><td style="text-align:left;"></td></tr></tbody></table><p>Veamos un sencillo ejemplo. Una vez lanzado el programa espera durante 10 segundos y a continuación mata el proceso.</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="shiki github-light" style="background-color:#fff;" tabindex="0"><code><span class="line"><span style="color:#D73A49;">public</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">class</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">ProcessDemo</span><span style="color:#24292E;"> {</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">   </span><span style="color:#D73A49;">public</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">static</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">void</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">main</span><span style="color:#24292E;">(</span><span style="color:#D73A49;">String</span><span style="color:#24292E;">[] </span><span style="color:#E36209;">args</span><span style="color:#24292E;">) </span><span style="color:#D73A49;">throws</span><span style="color:#24292E;"> Exception {</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">      ProcessBuilder pb </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">new</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">ProcessBuilder</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;C:</span><span style="color:#005CC5;">\\P</span><span style="color:#032F62;">rogram Files</span><span style="color:#005CC5;">\\M</span><span style="color:#032F62;">ozilla Firefox</span><span style="color:#005CC5;">\\f</span><span style="color:#032F62;">irefox.exe&quot;</span><span style="color:#24292E;">);</span></span>
<span class="line"><span style="color:#24292E;">      </span><span style="color:#6A737D;">// Effectively launch the process</span></span>
<span class="line"><span style="color:#24292E;">      Process p </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> pb.</span><span style="color:#6F42C1;">start</span><span style="color:#24292E;">();</span></span>
<span class="line"><span style="color:#24292E;">      </span><span style="color:#6A737D;">// Check is process is alive or not</span></span>
<span class="line"><span style="color:#24292E;">      </span><span style="color:#D73A49;">boolean</span><span style="color:#24292E;"> alive </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> p.</span><span style="color:#6F42C1;">isAlive</span><span style="color:#24292E;">();</span></span>
<span class="line"><span style="color:#24292E;">      </span><span style="color:#6A737D;">// Wait for the process to end for 10 seconds.</span></span>
<span class="line"><span style="color:#24292E;">      </span><span style="color:#D73A49;">if</span><span style="color:#24292E;"> (p.</span><span style="color:#6F42C1;">waitFor</span><span style="color:#24292E;">(</span><span style="color:#005CC5;">10</span><span style="color:#24292E;">, TimeUnit.SECONDS)) {</span></span>
<span class="line"><span style="color:#24292E;">          System.out.</span><span style="color:#6F42C1;">println</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;Process has finished&quot;</span><span style="color:#24292E;">);</span></span>
<span class="line"><span style="color:#24292E;">      } </span><span style="color:#D73A49;">else</span><span style="color:#24292E;"> {</span></span>
<span class="line"><span style="color:#24292E;">          System.out.</span><span style="color:#6F42C1;">println</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;Timeout. Process hasn&#39;t finished&quot;</span><span style="color:#24292E;">);</span></span>
<span class="line"><span style="color:#24292E;">      }</span></span>
<span class="line"><span style="color:#24292E;">      </span><span style="color:#6A737D;">// Force process termination.</span></span>
<span class="line"><span style="color:#24292E;">      p.</span><span style="color:#6F42C1;">destroy</span><span style="color:#24292E;">();</span></span>
<span class="line"><span style="color:#24292E;">      </span><span style="color:#6A737D;">// Check again if process remains alive</span></span>
<span class="line"><span style="color:#24292E;">      </span><span style="color:#D73A49;">boolean</span><span style="color:#24292E;"> alive </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> p.</span><span style="color:#6F42C1;">isAlive</span><span style="color:#24292E;">();</span></span>
<span class="line"><span style="color:#24292E;">      </span><span style="color:#6A737D;">// Get the process exit value</span></span>
<span class="line"><span style="color:#24292E;">      </span><span style="color:#D73A49;">int</span><span style="color:#24292E;"> status </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> p.</span><span style="color:#6F42C1;">exitValue</span><span style="color:#24292E;">();        </span></span>
<span class="line"><span style="color:#24292E;">   }</span></span>
<span class="line"><span style="color:#24292E;">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="custom-container info"><p class="custom-container-title">Códigos de terminación</p><p>Un código de salida (exit code o a veces también return code) es el valor que un proceso le devuelve a su proceso padre para indicarle cómo ha acabado. Si un proceso acaba con un valor de finalización 0 es que todo ha ido bien, cualquier otro valor entre 1 to 255 indica alguna causa de error.</p></div><div class="custom-container question"><p class="custom-container-title">Actividad psp.activities.U2A3_ExitValue</p><p>Crea un nuevo proyecto Java (Ant &gt; Java Application) (configura como nombre del proyecto U2A3_ExitValue y como clase principal psp.activities.U2A3_ExitValue). Prepara un programa que ejecute varios comandos (notepad, calc, comandos shell) uno detrás de otro, de forma secuencial y haz que tu programa obtenga el código de finalización de cada uno de ellos. Para cada programa imprime el nombre y su código de finalización.</p><p>Prueba a poner aplicaciones que no existan o comandos con parámetros incorrectos.</p><p>¿Qué hace Netbeans si pones System.exit(10) para acabar tu programa?. Fíjate en la consola. ¿Qué hace Netbeans si pones System.exit(0) para acabar tu programa.? Cuál es entonces el valor por defecto?</p></div><details class="custom-container details"><summary>Solución de U2A3_ExitValue</summary><div class="language-java line-numbers-mode" data-ext="java"><pre class="shiki github-light" style="background-color:#fff;" tabindex="0"><code><span class="line"><span style="color:#D73A49;">public</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">class</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">U2A3_ExitValue</span><span style="color:#24292E;"> {</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">public</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">static</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">void</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">main</span><span style="color:#24292E;">(</span><span style="color:#D73A49;">String</span><span style="color:#24292E;">[] </span><span style="color:#E36209;">args</span><span style="color:#24292E;">) {</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#D73A49;">do</span><span style="color:#24292E;"> {</span></span>
<span class="line"><span style="color:#24292E;">            </span><span style="color:#6A737D;">// Código para pedir un programa/comando a ejecutar</span></span>
<span class="line"><span style="color:#24292E;">            Scanner teclado </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">new</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">Scanner</span><span style="color:#24292E;">(System.in);</span></span>
<span class="line"><span style="color:#24292E;">            System.out.</span><span style="color:#6F42C1;">println</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;Introduce el programa / comando que quieres ejecutar (intro para acabar): &quot;</span><span style="color:#24292E;">);</span></span>
<span class="line"><span style="color:#24292E;">            String comando </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> teclado.</span><span style="color:#6F42C1;">nextLine</span><span style="color:#24292E;">();</span></span>
<span class="line"><span style="color:#24292E;">            </span></span>
<span class="line"><span style="color:#24292E;">            </span><span style="color:#D73A49;">if</span><span style="color:#24292E;"> (comando.</span><span style="color:#6F42C1;">equals</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;&quot;</span><span style="color:#24292E;">)) System.</span><span style="color:#6F42C1;">exit</span><span style="color:#24292E;">(</span><span style="color:#005CC5;">0</span><span style="color:#24292E;">);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">            </span><span style="color:#D73A49;">try</span><span style="color:#24292E;"> {</span></span>
<span class="line"><span style="color:#24292E;">                </span><span style="color:#6A737D;">// Preparamos el entrono de ejecución del proceso</span></span>
<span class="line"><span style="color:#24292E;">                </span><span style="color:#6A737D;">// Como no sabemos el contenido del comando, forzamos su conversión</span></span>
<span class="line"><span style="color:#24292E;">                </span><span style="color:#6A737D;">// a una lista para que no haya problemas con su ejecución</span></span>
<span class="line"><span style="color:#24292E;">                ProcessBuilder pb </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">new</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">ProcessBuilder</span><span style="color:#24292E;">(comando.</span><span style="color:#6F42C1;">split</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;</span><span style="color:#005CC5;">\\\\</span><span style="color:#032F62;">s&quot;</span><span style="color:#24292E;">));</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">                </span><span style="color:#6A737D;">// Lanzamos el proceso hijo</span></span>
<span class="line"><span style="color:#24292E;">                Process p </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> pb.</span><span style="color:#6F42C1;">start</span><span style="color:#24292E;">();          </span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">                </span><span style="color:#6A737D;">// Esperamos a que acabe para recoger el valor de salida</span></span>
<span class="line"><span style="color:#24292E;">                </span><span style="color:#D73A49;">int</span><span style="color:#24292E;"> exitValue </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> p.</span><span style="color:#6F42C1;">waitFor</span><span style="color:#24292E;">();</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">                </span><span style="color:#D73A49;">if</span><span style="color:#24292E;"> (exitValue </span><span style="color:#D73A49;">==</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">0</span><span style="color:#24292E;">) {</span></span>
<span class="line"><span style="color:#24292E;">                    System.out.</span><span style="color:#6F42C1;">println</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;El comando &quot;</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">+</span><span style="color:#24292E;"> pb.</span><span style="color:#6F42C1;">command</span><span style="color:#24292E;">().</span><span style="color:#6F42C1;">toString</span><span style="color:#24292E;">() </span><span style="color:#D73A49;">+</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&quot; ha finalizado bien&quot;</span><span style="color:#24292E;">);</span></span>
<span class="line"><span style="color:#24292E;">                } </span><span style="color:#D73A49;">else</span><span style="color:#24292E;"> {</span></span>
<span class="line"><span style="color:#24292E;">                    System.out.</span><span style="color:#6F42C1;">println</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;El comando &quot;</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">+</span><span style="color:#24292E;"> pb.</span><span style="color:#6F42C1;">command</span><span style="color:#24292E;">().</span><span style="color:#6F42C1;">toString</span><span style="color:#24292E;">() </span><span style="color:#D73A49;">+</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&quot; ha finalizado con errores. Código (&quot;</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">+</span><span style="color:#24292E;"> exitValue </span><span style="color:#D73A49;">+</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&quot;)&quot;</span><span style="color:#24292E;">);</span></span>
<span class="line"><span style="color:#24292E;">                }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">            } </span><span style="color:#D73A49;">catch</span><span style="color:#24292E;"> (InterruptedException | IOException </span><span style="color:#E36209;">ex</span><span style="color:#24292E;">) {</span></span>
<span class="line"><span style="color:#24292E;">                System.err.</span><span style="color:#6F42C1;">println</span><span style="color:#24292E;">(ex.</span><span style="color:#6F42C1;">getLocalizedMessage</span><span style="color:#24292E;">());</span></span>
<span class="line"><span style="color:#24292E;">                ex.</span><span style="color:#6F42C1;">printStackTrace</span><span style="color:#24292E;">();</span></span>
<span class="line"><span style="color:#24292E;">            }                       </span></span>
<span class="line"><span style="color:#24292E;">        } </span><span style="color:#D73A49;">while</span><span style="color:#24292E;"> (</span><span style="color:#005CC5;">true</span><span style="color:#24292E;">);</span></span>
<span class="line"><span style="color:#24292E;">    }</span></span>
<span class="line"><span style="color:#24292E;">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></details><div class="custom-container danger"><p class="custom-container-title">Gestión de excepciones</p><p>La llamada al método <strong>waitFor</strong> hace que el proceso padre se bloquee hasta que el proceso hijo termina o bien hasta que el bloqueo es interrumpido por alguna señal del sistema (Excepción) que recibe el proceso padre.</p><p>Es mejor gestionar las excepciones lo más cerca posible del origen en vez de pasarlas a niveles superiores.</p></div><h3 id="lanzar-una-clase-java-como-proceso-desde-otra-clase-java-en-el-mismo-proyecto" tabindex="-1">Lanzar una clase Java como proceso desde otra clase java en el mismo proyecto</h3><p>Para las actividades os pediré que programéis tanto el proceso padre como el proceso hijo. Para hacer eso, una de las clases tendrá que lanzar a la otra.</p><p>Para hacer esto, ambas clases deben tener un método main. Así que en las propiedades del proyecto Netbeans deberemos seleccionar cuál de las clases se ejecutará primero, normalmente la clase <code>Lanzador o Launcher</code> (proceso padre).</p><p><img src="`+i+'" alt="Seleccionar clase principal"></p><p>Antes de que una clase pueda lanzar a otra, al menos la segunda (proceso hijo) debe estar compilada, es decir, el archivo .class debe haberse creado dentro del directorio build/classes.</p><p><img src="'+d+`" alt="Seleccionar directorio de trabajo "></p><p>Entonces y sólo entonces, previa configuración de los parámetros de ejecución del proceso tal y como se muestra en el ejemplo, se podrá ejecutar una clase desde otra.</p><div class="custom-container info"><p class="custom-container-title">Directorio de trabajo</p><p>Si nos fijamos en la estructura de directorios de un proyecto y entendemos cómo se invocan unas clases a otras, entenderemos porqué el directorio de trabajo debe ser <em>build/classes</em>.</p><p>En Java, cuando se ejecuta una clase <code>java paquete.clase</code>, la MV Java espera encontrar los directorios que forman el paquete (psp/u2/actividad10) a partir del punto donde se está invocando el comando. Por eso, para que pueda encontrar la clase (el archivo .class), debemos ubicarnos previamente en el directorio <code>build/classes</code></p><div class="language-java line-numbers-mode" data-ext="java"><pre class="shiki github-light" style="background-color:#fff;" tabindex="0"><code><span class="line"><span style="color:#6A737D;">// Prepare the environment and the command</span></span>
<span class="line"><span style="color:#24292E;">ProcessBuilder pb </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">new</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">ProcessBuilder</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;java&quot;</span><span style="color:#24292E;">, </span><span style="color:#032F62;">&quot;psp.u2.actividad10.Sumador&quot;</span><span style="color:#24292E;">);</span></span>
<span class="line"><span style="color:#24292E;">pb.</span><span style="color:#6F42C1;">directory</span><span style="color:#24292E;">(</span><span style="color:#D73A49;">new</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">File</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;build/classes&quot;</span><span style="color:#24292E;">));</span></span>
<span class="line"><span style="color:#24292E;">Process p </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> pb.</span><span style="color:#6F42C1;">start</span><span style="color:#24292E;">();</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></div><div class="custom-container question"><p class="custom-container-title">Actividad psp.activities.U2A4_Lanzador</p><p>Crea un nuevo proyecto Java (Ant &gt; Java Application) (configura como nombre del proyecto U2A3_Lanzador y como clase principal psp.activities.U2A4_Lanzador).</p><p>Ahora, en el mismo proyecto y dentro del mismo paquete crea otra clase, Lanzado, con un método main que recibirá el nombre del programa que debe ejecutar como parámetro del método main(args). Haz que esta aplicación cree un nuevo proceso para ejecutar el programa recibido como parámetro.</p><p>La clase terminará devolviendo como código de finalización el que el programa lanzado le haya devuelto a ella.</p><blockquote><p>Método System.exit()</p><ul><li>Cero. El código cero debe devolverse cuando la ejecución del proceso haya ido bien, esto es, que ha terminado su ejecución sin problemas.</li><li>Distinto de cero. AUn código distinto de cero indica una terminación con errores. Java nos permite usar códigos diferentes para los diferentes tipos de error.</li></ul></blockquote><p>Por último, podemos hacer que U2A4_Lanzador pregunte al usuario qué aplicación quiere ejecutar y pasársela a la clase U2A4_Mandado.</p><p>En Lanzador recoge el código de finalización de Mandado y muestra un mensaje indicando si el proceso terminó bien o con errores.</p></div><details class="custom-container details"><summary>Solución de U2A4_Lanzador</summary><div class="language-java line-numbers-mode" data-ext="java"><pre class="shiki github-light" style="background-color:#fff;" tabindex="0"><code><span class="line"><span style="color:#D73A49;">public</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">class</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">U2A4_Launcher</span><span style="color:#24292E;"> {</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">public</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">static</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">void</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">main</span><span style="color:#24292E;">(</span><span style="color:#D73A49;">String</span><span style="color:#24292E;">[] </span><span style="color:#E36209;">args</span><span style="color:#24292E;">) {</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#6A737D;">// Código para pedir un programa/comando a ejecutar</span></span>
<span class="line"><span style="color:#24292E;">        Scanner teclado </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">new</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">Scanner</span><span style="color:#24292E;">(System.in);</span></span>
<span class="line"><span style="color:#24292E;">        System.out.</span><span style="color:#6F42C1;">println</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;Introduce el programa / comando que quieres ejecutar: &quot;</span><span style="color:#24292E;">);</span></span>
<span class="line"><span style="color:#24292E;">        String comando </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> teclado.</span><span style="color:#6F42C1;">nextLine</span><span style="color:#24292E;">();</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#D73A49;">try</span><span style="color:#24292E;"> {</span></span>
<span class="line"><span style="color:#24292E;">            </span><span style="color:#6A737D;">// Preparamos el entrono de ejecución del proceso</span></span>
<span class="line"><span style="color:#24292E;">            </span><span style="color:#6A737D;">// Como no sabemos el contenido del comando, forzamos su conversión</span></span>
<span class="line"><span style="color:#24292E;">            </span><span style="color:#6A737D;">// a una lista para que no haya problemas con su ejecución</span></span>
<span class="line"><span style="color:#24292E;">            comando </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&quot;java psp.activities.U2A4_Commander &quot;</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">+</span><span style="color:#24292E;"> comando;</span></span>
<span class="line"><span style="color:#24292E;">            ProcessBuilder pb </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">new</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">ProcessBuilder</span><span style="color:#24292E;">(comando.</span><span style="color:#6F42C1;">split</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;</span><span style="color:#005CC5;">\\\\</span><span style="color:#032F62;">s&quot;</span><span style="color:#24292E;">));</span></span>
<span class="line"><span style="color:#24292E;">            pb.</span><span style="color:#6F42C1;">directory</span><span style="color:#24292E;">(</span><span style="color:#D73A49;">new</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">File</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;build/classes&quot;</span><span style="color:#24292E;">));</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">            </span><span style="color:#6A737D;">// Lanzamos el proceso hijo</span></span>
<span class="line"><span style="color:#24292E;">            Process p </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> pb.</span><span style="color:#6F42C1;">start</span><span style="color:#24292E;">();          </span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">            </span><span style="color:#6A737D;">// Esperamos a que acabe para recoger el valor de salida</span></span>
<span class="line"><span style="color:#24292E;">            </span><span style="color:#D73A49;">int</span><span style="color:#24292E;"> exitValue </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> p.</span><span style="color:#6F42C1;">waitFor</span><span style="color:#24292E;">();</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">            </span><span style="color:#D73A49;">if</span><span style="color:#24292E;"> (exitValue </span><span style="color:#D73A49;">==</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">0</span><span style="color:#24292E;">) {</span></span>
<span class="line"><span style="color:#24292E;">                System.out.</span><span style="color:#6F42C1;">println</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;El comando &quot;</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">+</span><span style="color:#24292E;"> pb.</span><span style="color:#6F42C1;">command</span><span style="color:#24292E;">().</span><span style="color:#6F42C1;">toString</span><span style="color:#24292E;">() </span><span style="color:#D73A49;">+</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&quot; ha finalizado bien&quot;</span><span style="color:#24292E;">);</span></span>
<span class="line"><span style="color:#24292E;">            } </span><span style="color:#D73A49;">else</span><span style="color:#24292E;"> {</span></span>
<span class="line"><span style="color:#24292E;">                System.out.</span><span style="color:#6F42C1;">println</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;El comando &quot;</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">+</span><span style="color:#24292E;"> pb.</span><span style="color:#6F42C1;">command</span><span style="color:#24292E;">().</span><span style="color:#6F42C1;">toString</span><span style="color:#24292E;">() </span><span style="color:#D73A49;">+</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&quot; ha finalizado con errores. Código (&quot;</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">+</span><span style="color:#24292E;"> exitValue </span><span style="color:#D73A49;">+</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&quot;)&quot;</span><span style="color:#24292E;">);                </span></span>
<span class="line"><span style="color:#24292E;">            }</span></span>
<span class="line"><span style="color:#24292E;">        } </span><span style="color:#D73A49;">catch</span><span style="color:#24292E;"> (InterruptedException | IOException </span><span style="color:#E36209;">ex</span><span style="color:#24292E;">) {</span></span>
<span class="line"><span style="color:#24292E;">            System.err.</span><span style="color:#6F42C1;">println</span><span style="color:#24292E;">(ex.</span><span style="color:#6F42C1;">getLocalizedMessage</span><span style="color:#24292E;">());</span></span>
<span class="line"><span style="color:#24292E;">            ex.</span><span style="color:#6F42C1;">printStackTrace</span><span style="color:#24292E;">();</span></span>
<span class="line"><span style="color:#24292E;">        }                       </span></span>
<span class="line"><span style="color:#24292E;">    }</span></span>
<span class="line"><span style="color:#24292E;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D73A49;">public</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">class</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">U2A4_Commander</span><span style="color:#24292E;"> {</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">public</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">static</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">void</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">main</span><span style="color:#24292E;">(</span><span style="color:#D73A49;">String</span><span style="color:#24292E;">[] </span><span style="color:#E36209;">args</span><span style="color:#24292E;">) </span><span style="color:#D73A49;">throws</span><span style="color:#24292E;"> Exception {       </span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#6A737D;">// Lectura de información desde los parámetros de entrada </span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#6A737D;">// Se supone que recibimos: args[0] args[1] args[2] ..... args[args.length-1 --&gt; comando a ejecutar</span></span>
<span class="line"><span style="color:#24292E;">        String comando </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&quot;&quot;</span><span style="color:#24292E;">;</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#D73A49;">for</span><span style="color:#24292E;"> (</span><span style="color:#D73A49;">int</span><span style="color:#24292E;"> i </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">0</span><span style="color:#24292E;">; i </span><span style="color:#D73A49;">&lt;</span><span style="color:#24292E;"> args.length; i</span><span style="color:#D73A49;">++</span><span style="color:#24292E;">) {</span></span>
<span class="line"><span style="color:#24292E;">            comando </span><span style="color:#D73A49;">+=</span><span style="color:#24292E;"> args[i] </span><span style="color:#D73A49;">+</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&quot; &quot;</span><span style="color:#24292E;">;</span></span>
<span class="line"><span style="color:#24292E;">        }</span></span>
<span class="line"><span style="color:#24292E;">        comando.</span><span style="color:#6F42C1;">trim</span><span style="color:#24292E;">();</span></span>
<span class="line"><span style="color:#24292E;">                </span></span>
<span class="line"><span style="color:#24292E;">        ProcessBuilder pb </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">new</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">ProcessBuilder</span><span style="color:#24292E;">(comando.</span><span style="color:#6F42C1;">split</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;</span><span style="color:#005CC5;">\\\\</span><span style="color:#032F62;">s&quot;</span><span style="color:#24292E;">));            </span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#6A737D;">// Lanzamos el proceso hijo</span></span>
<span class="line"><span style="color:#24292E;">        Process p </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> pb.</span><span style="color:#6F42C1;">start</span><span style="color:#24292E;">();          </span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#6A737D;">// Esperamos a que acabe para recoger el valor de salida</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#D73A49;">int</span><span style="color:#24292E;"> exitValue </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> p.</span><span style="color:#6F42C1;">waitFor</span><span style="color:#24292E;">();</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">        System.</span><span style="color:#6F42C1;">exit</span><span style="color:#24292E;">(exitValue);</span></span>
<span class="line"><span style="color:#24292E;">    }    </span></span>
<span class="line"><span style="color:#24292E;">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></details><div class="custom-container warning"><p class="custom-container-title">Programación de clases &quot;hijas&quot;</p><p>Debemos tener en cuenta que una clase se puede ejecutar de forma independiente o puede ser llamada desde otro proceso.</p><p>Por eso, el código de las clases, hijas o padres, se hace sin tener en cuenta cómo van a ser llamadas. Debe ser <strong>independiente</strong> tal y como lo son unos procesos de otros.</p><p>Así, en el anterior proyecto yo podría ejecutar la clase psp.activities.U2A4_Commander de forma independiente, pasándole el nombre de los programas.</p><p>Puedo hacerlo invocándola desde línea de comandos o desde Netbeans:</p><ul><li>java psp.activities.U2A4_Commander programa1 programa2 programa3</li><li>En las propiedades del proyecto, en el apartado Run, seleccionando U2A4_Commander como clase principal y poniendo como Arguments: programa1 programa2 programa3</li></ul></div>`,20);function z(B,L){const c=p("DownloadPDF-component"),t=p("DocumentCover-component"),e=p("router-link"),o=p("ExternalLinkIcon");return u(),m("div",null,[n(c),n(t,{titulo:"2.2 Gestión de procesos en Java - ProcessBuilder y Process"}),E,s("nav",b,[s("ul",null,[s("li",null,[n(e,{to:"#_2-2-1-preparacion-y-configuracion-de-un-proceso"},{default:l(()=>[a("2.2.1 Preparación y configuración de un proceso")]),_:1}),s("ul",null,[s("li",null,[n(e,{to:"#modificar-el-comando-en-tiempo-de-ejecucion"},{default:l(()=>[a("Modificar el comando en tiempo de ejecución")]),_:1})]),s("li",null,[n(e,{to:"#configuraciones-adicionales-de-un-proceso"},{default:l(()=>[a("Configuraciones adicionales de un proceso")]),_:1})])])]),s("li",null,[n(e,{to:"#_2-2-2-acceso-al-proceso-una-vez-en-ejecucion"},{default:l(()=>[a("2.2.2 Acceso al proceso una vez en ejecución")]),_:1}),s("ul",null,[s("li",null,[n(e,{to:"#lanzar-una-clase-java-como-proceso-desde-otra-clase-java-en-el-mismo-proyecto"},{default:l(()=>[a("Lanzar una clase Java como proceso desde otra clase java en el mismo proyecto")]),_:1})])])])])]),g,A,s("ul",null,[s("li",null,[F,a(),s("a",D,[a("Referencia API Java"),n(o)])]),s("li",null,[q,a(),s("a",h,[a("Referencia API Java"),n(o)])])]),C,s("div",f,[j,S,P,s("p",null,[s("a",x,[a("Referencia del comando shutdown de Windows"),n(o)])])]),_,s("blockquote",null,[s("p",null,[s("a",w,[a("Especificación java.lang.Process"),n(o)])])]),k])}const I=y(v,[["render",z],["__file","processbuilder.html.vue"]]);export{I as default};
